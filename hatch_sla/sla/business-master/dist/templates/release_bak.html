{% extends "base.html" %}

{% block title %} release {% endblock %}

{% block meta %}
  {{ super() }}
   <meta charset="utf-8">
{% endblock %}

{% block styles %}
  {{ super() }}
  <script src="/static/js/echarts.common.min.js"></script>
{% endblock %}

{% block page_content %}
    <!-- 为ECharts准备一个具备大小（宽高）的Dom -->
    <div class="card-header" style="display: flex; justify-content: space-between" >
        <div style="display: flex;align-items: flex-start;padding-top: 10px">
            <p style="font-weight:bold;font-size:17px;"> earthworm 发布记录</p>
        </div>
        <div style="display: flex;align-items: flex-end;padding-bottom: 5px">
            <form action="{{ url }}" method="get" >
               <input type="radio" class="custom-control-input" name="query_time" value="1d" {% if  re[0]['query_time'] ==  "1d" %} checked {% endif %}> 
               <span class="custom-control-label" style="padding-right: 15px">昨天</span>
               <input type="radio" class="custom-control-input" name="query_time" value="3d" {% if  re[0]['query_time'] ==  "3d" %} checked {% endif %}> 
               <span class="custom-control-label" style="padding-right: 15px">前三天</span>
               <input type="radio" class="custom-control-input"  name="query_time" value="7d" {% if  re[0]['query_time'] ==  "7d" %}checked {% endif %}>
               <span class="custom-control-label" style="padding-right: 15px">上周</span>
               <input type="radio" class="custom-control-input"  name="query_time" value="1m" {% if  re[0]['query_time'] ==  "1m" %}checked {% endif %}>
               <span class="custom-control-label" style="padding-right: 15px">上月</span>

               <button type="submit" class="btn btn-default" > Search </button>
            </form>
        </div> 
     </div>
    <div id="main" style="width: 100%;height: 800px;" ></div>

    <script type="text/javascript">
        // 通过 dom id 获取echart 实例
        var myChart = document.getElementById('main');
        // 初始化 echart 实例
        var myChart = echarts.init(myChart);

        // 指定图表的配置项和数据
        var option = {
            //title : {
            //    text: 'earthworm发布次数记录',
            //    x:'center'
            //},
            tooltip : {
                trigger: 'item',
                formatter: "{a} <br/>{c0} ({d}%)"
            },
            //legend: {
            //    type: 'scroll',
            //    orient: 'vertical',
            //    right: 0,
            //    top: '25%',
            //},
            dataset: {
                // 提供一份数据。
                source: [
                    [ '业务线', '数量'],
                    {% for i in re %}
                    [ '{{ i['name'] }}({{ i['person'] }})',  {{ i['release_count'] }}],
                    {% endfor %}
                ]
            },
            series : [
                {
                    name: '业务线',
                    type: 'pie',
                    radius : '65%',
                    center: ['45%', '45%'],
                    itemStyle: {
                        emphasis: {
                            shadowBlur: 10,
                            shadowOffsetX: 0,
                            shadowColor: 'rgba(0, 0, 0, 0.5)'
                        }
                    }
                }
            ]
        };

        // 使用刚指定的配置项和数据显示图表。
        myChart.setOption(option);
        //浏览器大小改变时重置大小
        //myChartContainer();
         window.onresize = function () {
            myChart.resize(
            );
         };

    </script>


{% endblock %}
